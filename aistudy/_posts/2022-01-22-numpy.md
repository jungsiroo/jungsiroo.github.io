---
layout: post
title: Numpy
description: >
  Naver boostcamp AI Tech - Python Basics for AI
hide_description: false
category: aistudy
image:
  path: ../../assets/img/thumbnail/numpy.png
---

**í•´ë‹¹ ì¸ë„¤ì¼ì€ `Wonkook Lee` ë‹˜ì´ ë§Œë“œì‹  [`Thumbnail-Maker`](https://wonkooklee.github.io/thumbnail_maker/){:target="_blank"} ë¥¼ ì´ìš©í•˜ì˜€ìŠµë‹ˆë‹¤**
{:.figcaption}

* this unordered seed list will be replaced by the toc
{:toc}

**ğŸ“ Numpy**

> **`í•µì‹¬ ìƒê°` - ì–´ë–»ê²Œ í–‰ë ¬ê³¼ ë§¤íŠ¸ë¦­ìŠ¤ë¥¼ ì½”ë“œë¡œ í‘œí˜„í•  ê²ƒì¸ê°€?**
> 

$$
2x_1 + 2x_2 + x_3 = 9 \\2x_1 - x_2 + 2x_3 = 6\\x_1 - x_2 + 2x_3=5
$$

$$
\left[
\begin{matrix}
    2 & 2 & 1 & 9\\
    2 & -1 & 2 & 6 \\ 1 & -1 & 2 & 5   \end{matrix}
\right]
$$

```python
coefficient_matrix = [[2,2,1], [2,-1,2], [1, -1, 2]]
constant_vector = [9,6,5]
```

**Problems**

- ë‹¤ì–‘í•œ Matrix ê³„ì‚°ì„ ì–´ë–»ê²Œ ë§Œë“¤ ê²ƒì¸ê°€?
- êµ‰ì¥íˆ í° Matrix ì— ëŒ€í•œ í‘œí˜„
- ì²˜ë¦¬ ì†ë„ ë¬¸ì œ - `pythonì€ interpreter ì–¸ì–´`

**So We should use Numpy!**



# ğŸ¦´ numpy íŠ¹ì§•

- ì¼ë°˜ list ì— ë¹„í•´ ë¹ ë¥´ê³ , ë©”ëª¨ë¦¬ íš¨ìœ¨ì 
- ë°˜ë³µë¬¸ ì—†ì´ ë°ì´í„° ë°°ì—´ì— ëŒ€í•œ ì²˜ë¦¬ë¥¼ ì§€ì›í•¨
- ì„ í˜•ëŒ€ìˆ˜ì™€ ê´€ë ¨ëœ ë‹¤ì–‘í•œ ê¸°ëŠ¥ì„ ì œê³µí•¨
- C, C++, fortran ë“±ì˜ ì–¸ì–´ì™€ í†µí•© ê°€ëŠ¥

# ğŸ¥“ array creation

```python
test_arr = np.array(["1",4,5,6]. float)
print(test_arr)
# 1.0 4.0 5.0 6.0 

"""
shape : numpy array ì˜ dimension êµ¬ì„±ì„ ë°˜í™˜í•¨
dtype : numpy array ì˜ ë°ì´í„° type ì„ ë°˜í™˜í•¨
"""

test_arr = np.array([1,4,5,"8"], float)
test_arr.dtype #float64
test_arr.shape #(4,)

matrix = [[1,2,3,4], [4,5,6,7], [7,8,9,9]]
np.array(matrix,int)

matrix.shape #(3, 4)
```

# ğŸ›ï¸ Handling Shape

## reshape

> Array ì˜ shapeì˜ í¬ê¸°ë¥¼ ë³€ê²½í•¨, element ì˜ ê°¯ìˆ˜ëŠ” ë™ì¼

ex. **(2,4)â†’(8,)**

```python
np.array(test_matrix).reshape(2,4).shape
# 2, 4

np.array(test_matrix).reshape(-1,2).shape
# 4, 2

"""
-1 ì˜ ì˜ë¯¸ëŠ” sizeë¥¼ ê¸°ë°˜ìœ¼ë¡œ row/column ê°œìˆ˜ ì„ ì •
"""
```

## flatten

> ë‹¤ì°¨ì› array ë¥¼ 1ì°¨ì› array ë¡œ ë³€í™˜

ex. **(2,2,4)â†’(16,)**

# ğŸ‘ï¸â€ğŸ—¨ï¸ indexing for numpy array

* listì™€ ë‹¬ë¦¬ ì´ì°¨ì› ë°°ì—´ì—ì„œ [0,0] í‘œê¸°ë²•ì„ ì œê³µ
* matrix ì¼ ê²½ìš° ì•ì€ `row` ë’¤ëŠ” `column` ì„ ì˜ë¯¸í•¨

```python
a = np.array([[1,2,3], [4.5, 5, 6]], int)

print(a[0][0]) # 1
print(a[0,0]) # 1
```

# ğŸ“ slicing for numpy array

- listì™€ ë‹¬ë¦¬ í–‰ê³¼ ì—´ ë¶€ë¶„ì„ ë‚˜ëˆ ì„œ slicing ì´ ê°€ëŠ¥í•¨
- matrix ì˜ ë¶€ë¶„ì§‘í•©ì„ ì¶”ì¶œí•  ë•Œ ìœ ìš©í•¨

```python
a = np.array([[1,2,3,4,5], [6,7,8,9,10]], int)
a[:, 2:] # ì „ì²´ rowì˜ 2ì—´ ì´ìƒ
#[[3,4,5], [8,9,10]]

a[1, 1:3] # 1 row ì˜ 1ì—´~2ì—´
# [7,8]

a[1:3] # 1 Row ~ 2 Row ì˜ ì „ì²´
# [6,7,8,9,10]

```

# ğŸ”¥ creation function

## arange

> array ì˜ ë²”ìœ„ë¥¼ ì§€ì •í•˜ì—¬, ê°’ì˜ list ë¥¼ ìƒì„±í•˜ëŠ” ëª…ë ¹ì–´

<pre><code class="python">np.arange(5) #array([0,1,2,3,4])

np.arange(0,5,0.5) #(start, end, step)
# array([0., 0.5, 1., ... , 4.5])
</code></pre>

## zeros - 0ìœ¼ë¡œ ê°€ë“ì°¬ ndarray ìƒì„±

```python
np.zeros(shape=(10,), dtype=np.int8)
# array([0,0,0,0,0,0,0,0,0], dtype=int8)

np.zeros((2,5))
# array([[0., 0., 0., 0., 0.],
#        [0., 0., 0., 0., 0.]])
```

## identity

> ë‹¨ìœ„ í–‰ë ¬ (i í–‰ë ¬) ì„ ìƒì„±í•¨

<pre><code class="python">np.identity(n=3, dtype=np.int8)
# array([1,0,0],
#       [0,1,0],
#       [0,0,1], dtype=int8)

np.identity(5)
</code></pre>

## diag

> ëŒ€ê° í–‰ë ¬ì˜ ê°’ì„ ì¶”ì¶œí•¨

<pre><code class="python">matrix = np.arange(9).reshape(3,3)
np.diag(matrix)
# array([0,4,8])
</code></pre>

## random sampling

> ë°ì´í„° ë¶„í¬ì— ë”°ë¥¸ sampling ìœ¼ë¡œ array ë¥¼ ìƒì„±

<pre><code class="python">np.random.uniform(0,1,10).reshape(2,5) #ê· ë“±ë¶„í¬
</code></pre>

# ğŸšï¸ operation function

## sum

> ndarray ì˜ elementë“¤ ê°„ì˜ í•©ì„ êµ¬í•¨, ë¦¬ìŠ¤íŠ¸ì˜ sum ê¸°ëŠ¥ê³¼ ë™ì¼


```python
test_arr = np.arange(1,11)
test_arr.sum(dtype=np.float)

#55.0
```

## axis ê°œë…

> ëª¨ë“  operation function ì„ ì‹¤í–‰í•  ë•Œ ê¸°ì¤€ì´ ë˜ëŠ” dimension ì¶•
> 

â¬‡ï¸ : axis=0

â¡ï¸ : axis=1

```python
test_arr = np.arange(1,13).reshape(3,4)
test_arr.sum(axis=1), test_arr.sum(axis=0)

"""
1  2  3  4
5  6  7  8
9 10 11 12

(array([10,26,42], array([15,18,21,24])
"""
```

## mean & std

> ndarrayì˜ elementë“¤ ê°„ì˜ í‰ê·  ë˜ëŠ” í‘œì¤€ í¸ì°¨ë¥¼ ë°˜í™˜
> 

```python
test_arr = np.arange(1,13).reshape(3,4)

"""
1  2  3  4
5  6  7  8
9 10 11 12
"""

test_arr.mean(), test_arr.mean(axis=0)
(6.5, array([5., 6., 7., 8.]))
```

## concatenate

> numpy  array ë¥¼ í•©ì¹˜ëŠ” í•¨ìˆ˜
> 

### vstack & hstack

```python
"""
1 2 3       1 2 3
        ->  2 3 4 
2 3 4
"""

a = np.arange(1,4).reshape(3,)
b = np.arange(2,5).reshape(3,)

np.vstack((a,b))
# array([1,2,3]
#        [2,3,4)

"""
1    2     1 2  
2    3  -> 2 3
3    4     3 4
"""

a = np.array([[1], [2], [3]])
b = np.array([[2], [3], [4]])

np.hstack((a,b))
# array([1,2]
#       [2,3],
#       [3,4] )
```

### concatenate

> numpy array ë¥¼ ë¶™ì´ëŠ” í•¨ìˆ˜
> 

```python
# ìœ„ì™€ ë˜‘ê°™ì€ array

a = np.arange(1,4).reshape(3,)
b = np.arange(2,5).reshape(3,)

np.concatenate((a,b), axis =0)

a = np.array([[1,2], [3,4]]
b = np.array([5,6]) #shape = (2,)
b = b[np.newaxis, :] # ì¶•ì„ í•˜ë‚˜ ì¶”ê°€í•˜ëŠ” ê²ƒ
b.shape #(1,2)

"""
ë„˜íŒŒì´ ê°ì²´ì— .Të¥¼ í•˜ë©´ shapeì´ (2, 1)ë¡œ ë³€í•˜ê²Œ ë¨ = transpose ì—°ì‚°
"""

np.concatenate((a, b.T), axis=1)

```

## Operations betwwen arrays

> numpy ëŠ” array ê°„ì˜ ê¸°ë³¸ì ì¸ ì‚¬ì¹™ ì—°ì‚°ì„ ì§€ì›í•¨
> 

### basic

```python
test_a = np.array([[1,2,3], [4,5,6]], float)
test_a + test_a #Matrix + Matrix ì—°ì‚°

"""
array([[2., 4., 6.,]
      [8., 10., 12.]])
"""

test_a - test_a

"""
array([[0., 0., 0.,]
      [0., 0., 0.]])
"""

test_a * test_a #Matrix ë‚´ element ë“¤ ê°„ ê°™ì€ ìœ„ì¹˜ì— ìˆëŠ” ê°’ë“¤ë¼ë¦¬ ì—°ì‚°
                # shape ì´ ê°™ì„ ë•Œ ì¼ì–´ë‚¨

"""
array([[1., 4., 9.,]
      [16., 25., 36.]])
"""
```

### Dot product

> Matrix ì˜ ê¸°ë³¸ ì—°ì‚°, dot í•¨ìˆ˜ ì‚¬ìš©
> 

```python
test_a = np.arange(1,7).reshape(2,3)
test_b = np.arange(7,13).reshape(3,2)

test_a.dot(test_b)

"""
array([[58, 64]
      [139, 154]])
"""
```

### transpose

> ì „ì¹˜í–‰ë ¬
> 

```python
test_a = np.arange(1,7).reshape(2,3)
"""
[[1 2 3]
 [4 5 6]]
"""

test_a.T
"""
[[1 4]
 [2 5]
 [3 6]]
"""
```

### broadcasting

> shape ì´ ë‹¤ë¥¸ ë°°ì—´ ê°„ ì—°ì‚°ì„ ì§€ì›í•˜ëŠ” ê¸°ëŠ¥
> 

```python
test_matrix = np.array(1,7).reshape(2,3)
scalar = 3.

test_matrix + scalar
"""
array([[4., 5., 6.],
       [7., 8., 9.]])
"""

"""
scalar - vector ë¿ë§Œ ì•„ë‹ˆë¼
vector - vector ë„ ì§€ì›
ì´ ê²½ìš° ë‘˜ì˜ shape ì„ ì•Œì•„ì„œ ë§ì¶°ì¤Œ
"""
```

# âš”ï¸ Comparisons

## all & any

```python
a = np.arange(10)

a < 4

"""
array([ True,  True,  True,  True, False, False, False, False, False,
       False])
"""

np.any(a>5), np.any(a<0) # í•˜ë‚˜ë¼ë„ ì¡°ê±´ì— ë§Œì¡±í•˜ë©´ True
# True, False

np.all(a>5), np.all(a<10) # ëª¨ë‘ê°€ ì¡°ê±´ì— ë§Œì¡±í•´ì•¼ True
# False, True
```

## comparison operation #1

> numpy ëŠ” ë°°ì—´ì˜ í¬ê¸°ê°€ ë™ì¼í•  ë•Œ element ê°„ ë¹„êµì˜ ê²°ê³¼ë¥¼ boolean type ìœ¼ë¡œ ë°˜í™˜

<pre><code class="python">test_a = np.array([1,3,0], float)
test_b = np.array([5,2,1], float)

test_a > test_b
# array([False,  True, False])
</code></pre>


## comparison operation #2


<pre><code class="python">a = np.array([1,3,0], float)
np.logical_and(a > 0, a < 3) #and ì¡°ê±´ì˜ condition
# array([True, False, False])

b = np.array([True, False, True], bool)
np.logical_not(b)
# array([False, True, False])

c = np.array([False, True, False], bool)
np.logical_or(b,c) # OR ì¡°ê±´ì˜ condition
# array([True, True, True])
</code></pre>

## np.where

<pre><code class="python">np.where(a>0, 3, 2) #where(condition, TRUE, FALSE)
# [3, 3, 2]

a = np.arange(10)
np.where(a>5)
# (array([6, 7, 8, 9]),)
</code></pre>

## argmax & argmin

> array ë‚´ ìµœëŒ€ê°’ ë˜ëŠ” ìµœì†Ÿê°’ì˜ `index` ë¥¼ ë°˜í™˜

<pre><code class="python">a = np.array([1,2,4,5,8,78,23,3])
np.argmax(a), np.argmin(a)
#(5,0)
</code></pre>

> axis ê¸°ë°˜ì˜ ë°˜í™˜
> 

```python
a = np.array([[1,2,4,7], [9,88,6,45], [9,76,3,4]])
np.argmax(a, axis=1), np.argmax(a, axis=0)

#(array([3, 1, 1]), array([1, 1, 1, 1]))

"""
1  2  4  7
9 88  6 45
9 76  3  4

axis = 0 ì¼ë•ŒëŠ” 9 88 6 45 ê°€ max ì´ë¯€ë¡œ ê·¸ì— ë§ëŠ” ì¸ë±ìŠ¤
axis = 1 ì¼ë•ŒëŠ” 7 88 76 ì´ max ì´ë¯€ë¡œ ê·¸ì— ë§ëŠ” ì¸ë°ìŠ¤
"""
```

# ğŸ¸ boolean & fancy index

> íŠ¹ì • ì¡°ê±´ì— ë”°ë¥¸ ê°’ì„ ë°°ì—´ í˜•íƒœë¡œ ì¶”ì¶œ
> 

> Comparison operation í•¨ìˆ˜ë“¤ë„ ëª¨ë‘ ì‚¬ìš©ê°€ëŠ¥
> 

## boolean indexing

```python
test_arr = np.array([1,4,0,2,3,8,9,7], float)
test_arr[test_arr > 3]

"""
array([4., 8., 9., 7.])
"""
```

## fancy indexing

> numpyëŠ” array ë¥¼ index valueë¡œ ì‚¬ìš©í•´ì„œ ê°’ ì¶”ì¶œ
> 

```python
a = np.array([2,4,6,8], float)
b = np.array([0,0,1,3,2,1], int) # ë°˜ë“œì‹œ integer ë¡œ ì„ ì–¸

a[b] #a.take(b) ì™€ ê°™ìŒ

#array([2., 2., 4., 8., 6., 4.])
```

# ğŸ‘“ numpy data i/o

## loadtxt & savetxt

> text type ì˜ ë°ì´í„°ë¥¼ ì½ê³ , ì €ì¥í•˜ëŠ” ê¸°ëŠ¥
> 

```python
a = np.loadtxt("./populations.txt") #íŒŒì¼ í˜¸ì¶œ
a[:10]

a_int = a.astype(int)
np.savetxt("int_data.csv", a_int, delimiter=",") #íŒŒì¼ ì €ì¥

#numpy object - npy
np.save("npy_test_object", arr=a_int)
a_test = np.load(file="npy_test_object.npy")
```

<hr>

`numpy` ì— ëŒ€í•œ ê¸°ë³¸ì ì¸ ê²ƒì„ ë°°ì›Œë³´ì•˜ë‹¤. ìƒì†Œí•œ ê°œë…ë“¤ì´ ë§ì•˜ìœ¼ë¯€ë¡œ ë³µìŠµ ë§ì´ í•˜ì!